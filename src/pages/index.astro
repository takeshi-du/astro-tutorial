---
// src/pages/index.astro
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro'; // 適切なレイアウトを指定
import { getPostUrl } from '../utils/url';

// 1. 'blog'コレクションの記事をすべて取得
const allPosts = await getCollection('blog');

// 2. 公開日 (pubDate) の新しい順に記事をソート
//    new Date() を使って日付として比較する
const sortedPosts = allPosts.sort((a, b) =>
  b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

// 3. 最新の5件だけを取得 (sliceを使用)
const recentPosts = sortedPosts.slice(0, 5);

// 他のトップページ用データなど...
const pageTitle = "ようこそ！";
---
<BaseLayout title={pageTitle}>
  <h1 class="text-3xl font-bold text-blue-600 mb-4">{pageTitle}</h1>
  <p class="text-gray-700 leading-relaxed">これはTailwind CSSでスタイルされた段落です。</p>
  <p>このサイトのトップページです。</p>

  {/* ↓ ここから新着記事一覧を追加 */}
  <h2>新着記事</h2>
  <ul>
    {recentPosts.map((post) => (
      <li>
        {/* getPostUrlヘルパーでリンク先URLを生成 */}
        <a href={getPostUrl(post)}>{post.data.title}</a>
        <span style="font-size: 0.8em; margin-left: 8px;">
          ({post.data.pubDate.toLocaleDateString()})
        </span>
      </li>
    ))}
  </ul>
  {/* ↑ ここまで新着記事一覧 */}

  {/* 他のトップページのコンテンツ... */}
</BaseLayout>
